# Huffman Coding
학교 프로젝트 수업에서 구현한 허프만 압축 코딩이다. 허프만 코딩은 유명한 압축 알고리즘 중 하나이다. 수업에서 구현한 허프만 코딩이 여러 문제점이 보여서 되돌아볼 겸 다시 구현해보았다.

## 이전 허프만 코딩 특징
이전 허프만 코딩의 코드는 ```v0``` 폴더안에서 확인할 수 있다. 이 코드는 허프만 코딩뿐 아니라 run length 압축 알고리즘도 포함되어 있으며, 허프만 코딩 부분에서는 아래와 같이 몇 가지 문제점이 있었다.
- 허프만 코딩 인코딩 후 헤더 부분을 비트로 저장하지 않았다. 즉, 파일의 정보와 허프만 코드를 하나하나 4바이트 문자로 저장하여 파일 크기면에서 비효율적이다.
- 허프만 테이블을 저장한 헤더 형식은 ```<전체 문자열 갯수>|<문자1><문자1의 허프만 코드>|<문자2><문자2의 허프만코드>|...``` 이다. 여기서 문제점은 전체 문자열 갯수를 저장할 필요없는 정보이고, 구분 문자('|')를 가지고 있으므로 모든 아스키 코드 문자를 표현할 수 없다.

새로 구현한 코드에서는 최소한 위의 두 문제점은 해결하려고 하였다.

## 개발 기간 및 환경
- 기간
  - 이전 버전: 2016.11
  - 현재 버전: 2019.01
- Language: C

## 개발 내용
기본적으로 허프만 코딩은 최소 힙(heap)과 트리 자료구조를 이용한 것이다. 허프만 코드를 만드는 과정은 아래와 같다.
1. 압축할 파일 내용에서 출현한 문자들의 빈도 수를 계산한다.
2. 출현한 문자, 해당 문자의 빈도 수를 저장한 노드(트리 노드)를 만들고 이 노드를 최소 힙에 모두 삽입한다. 이 최소 힙은 문자의 빈도수에 따른 최소 힙이다.(즉, 빈도수가 가장 작은 노드가 가장 먼저 나온다.)
3. 해당 최소 힙에서 노드 2개를 꺼내 하나의 트리(부모 노드는 꺼낸 2개의 노드의 빈도수를 합친 값을 갖는다.)를 만든다.
4. 다시 이 트리 노드를 힙에 삽입한 후, 다시 노드 2개를 꺼내 하나로 합치는 과정을 반복한다. 이 과정을 힙에 노드가 하나 남을 때 까지 반복한다.
5. 하나 남은 노드가 모든 문자의 정보를 갖는 허프만 트리가 된다. 이 허프만 트리에서 루트부터 아래로 탐색하면서 왼쪽 노드로 갈 때는 ```0```, 오른쪽 노드는 ```1``` 로 하여 허프만 코드를 만든다.(실제 문자는 모두 리프 노드인 것을 이용한다.)

이렇게 만들어진 허프만 코드를 이용하여 파일 본문 내용을 모두 허프만 코드로 대체한다. 그리고 허프만 테이블(문자와 그 허프만 코드로 이루어진 테이블) 내용을 헤더 부분에 포함하여 인코딩 파일을 만든다. 이와 같은 과정이 허프만 인코딩이 수행되는 과정이고, 디코딩은 인코딩 파일의 헤더를 분석하여 다시 허프만 테이블을 만들고, 이를 이용하여 본문 내용을 해석한다.

이전 버전의 첫 번째 문제였던 헤더 내용을 문자(char)로 표현한 것을 모두 비트로 바꿔 해결하였다.

### 헤더 내용
이전 버전에서 발견한 문제점인 허프만 테이블 내용 형식을 아래와 같이 개선하였다.
```
<출현한 문자 갯수(8bit)><문자1(8bit)><문자1의 허프만 코드 길이(5bit)><문자1의 허프만 코드><문자2(8bit)><문자2의 허프만 코드 길이(5bit)><문자2의 허프만 코드>...
```
위의 형식에서 괄호안의 비트는 고정 비트이다. 아스키 코드 개수는 128개이므로 8비트로 모두 표현할 수 있다. 그러므로 출현한 문자 개수와 문자는 8비트내에서 모두 표현가능하다. 허프만 코드의 자료를 찾아보면서 아스키 코드에서 허프만 코드의 길이가 16을 넘지 않는다는 것을 확인하여 허프만 코드 길이 비트는 5비트로 정하였다. 마지막 허프만 코드는 길이에 따라 가변 크기이다.

### 또 다른 문제점
현재 버전도 문제점을 가지고 있다. 인코딩 과정에서 모든 내용을 비트로 계산하기 때문에 문자의 크기 8bit(1byte)에 나누어 떨어져야 한다. 하지만 모든 파일이 8bit에 맞춰서 저장되지 않으므로 1byte에서 최대 7bit의 잉여 비트가 남을 수 있다. 디코딩 과정에서 이 잉여 비트에 해당하는 허프만 코드가 있다면 쓰레기 값이 들어갈 수 있다.

## 사용 방법
사용 방법은 현재 버전 기준이며, ```exe``` 디렉토리안에 있는 실행 파일로 실행하거나 모든 코드 파일을 다운로드 받아서 실행해볼 수도 있다.

![mainscreen](https://user-images.githubusercontent.com/34755287/51383153-fbae7880-1b5b-11e9-9c33-0ed98bbd5703.JPG)

해당 프로젝트를 실행하면 위와 같은 화면이 출력된다. 여기서 인코딩 과정은 아래와 같다.
1. 숫자 1 입력(화면이 바뀐다.)
2. 인코딩할 파일을 입력한다.(EX, 경로/파일.txt)
3. 인코딩시 필요한 허프만 테이블 정보와 압축률을 알고 싶다면 y(Y) 를 입력하고, 그렇지 않다면 아무 키나 입력한다.(파일로 저장된다.)

디코딩 과정은 다음과 같다.
1. 숫자 2 입력(화면이 바뀐다.)
2. 디코딩할 파일을 입력한다.(EX, 경로/파일.txt)
3. 디코딩시 필요한 허프만 테이블 정보를 알고 싶다면 y(Y) 를 입력하고, 그렇지 않다면 아무 키나 입력한다.(파일로 저장된다.)

테스트 텍스트 파일과 해당 텍스트 파일의 허프만 코딩 정보들을 확인하고 싶다면 ```test``` 디렉토리안을 살펴보자.
